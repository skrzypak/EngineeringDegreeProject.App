<div class="">

  <section class="section px-5 py-5">
    <div class="container">
      <div class="box">

        <nav class="level" [formGroup]="ngFrmCtrl.frm">
          <!-- Left side -->
          <div class="level-left">

          </div>

          <!-- Right side -->
          <div class="level-right">
            <div class="level-item">
              <input style="width: 145px" formControlName="startDate" id="startDate" onfocus="(this.type='date')" name="startDate" type="text" class="input" placeholder="Start">
            </div>
            <div class="level-item">
              <input style="width: 145px" formControlName="endDate" id="endDate" onfocus="(this.type='date')" name="endDate" type="text" class="input" placeholder="End">
            </div>
            <div class="level-item">
              <button class="button is-info" #searchBtn (click)="search()">Search</button>
            </div>

          </div>
        </nav>

        <div class="table-container" *ngIf="this.fetched.msv.data.length > 0">
          <table class="table is-fullwidth table is-bordered is-narrow">
            <ng-container *ngFor="let product of this.fetched.msv.data">
              <thead>
              <tr class="has-background-link-light"><th>Name</th><th>Code</th><th colspan="4">Description</th></tr>
              </thead>
              <tbody>
              <ng-container>
                <tr>
                  <td class="py-2">{{product.key.name}}</td>
                  <td class="py-2">{{product.key.code}}</td>
                  <td class="py-2" colspan="4">{{product.key.description}}</td>
                </tr>
                <tr class="has-background-warning-light"><th>Unit</th><th>Total quantity</th><th>Total Net Value</th><th>Total Vat Value</th><th>Total Gross Value</th></tr>
                <ng-container *ngFor="let value of product.values">
                  <ng-container *ngFor="let v of value.values">
                    <tr class="has-text-left">
                      <td class="py-2">
                        {{v.key.unitMeasureValue}} {{unitPackage.convert(value.unit)}}
                      </td>
                      <td class="py-2">
                        {{v.totalQuantity}}
                      </td>
                      <td class="py-2">
                        {{v.totalNetValue}}
                      </td>
                      <td class="py-2">
                        {{v.totalVatValue}}
                      </td>
                      <td class="py-2">
                        {{v.totalGrossValue}}
                      </td>
                    </tr>
                  </ng-container>
                </ng-container>
              </ng-container>
              <br />
              </tbody>
            </ng-container>
          </table>
        </div>

        <div class="table-container" *ngIf="this.fetched.msv.data.length > 0 "><!--&& this.ngFrmCtrl.frm.value.suppliersIds.length > 0">-->
          <table class="table is-fullwidth table is-bordered is-narrow">
            <ng-container *ngFor="let supplier of this.fetched.msv.data">
              <thead>
              <tr style="background-color: #507ee1"><th colspan="4">Name</th><th>NIP</th></tr>
              </thead>
              <tbody>
              <ng-container>
                <tr>
                  <td class="py-2" colspan="4">{{supplier.key.companyName}}</td>
                  <td class="py-2">{{supplier.key.nip}}</td>
                </tr>

                <ng-container *ngFor="let product of supplier.products">
                  <tr style="background-color: #dc774f" class="has-text-centered">
                    <th class="py-2" colspan="4">{{product.key.name}}</th>
                    <th class="py-2">{{product.key.code}}</th>
                  </tr>
                  <tr style="background-color: #dc774f"><th>Package</th><th>Total Quantity</th><th>Total Net</th><th>Total Vat</th><th>Total Gross</th></tr>

                  <ng-container *ngFor="let unit of product.units">
                    <tr class="has-text-left">
                      <td class="py-2">
                        {{unit.key.unitMeasureValue}} {{unitPackage.convert(product.key.unit)}}
                      </td>
                      <td class="py-2">
                        {{unit.productQuantity}}
                      </td>
                      <td class="py-2">
                        {{unit.productNetValue}}
                      </td>
                      <td class="py-2">
                        {{unit.productVatValue}}
                      </td>
                      <td class="py-2">
                        {{unit.productGrossValue}}
                      </td>
                    </tr>
                  </ng-container>

                  <tr class="has-text-left" style="background-color: #e0e708">
                    <td class="py-2">
                      {{product.totalMeasureUnitValue}} {{unitPackage.convert(product.key.unit)}}
                    </td>
                    <td class="py-2">
                      -
                    </td>
                    <td class="py-2">
                      {{product.totalNetValue}}
                    </td>
                    <td class="py-2">
                      {{product.totalVatValue}}
                    </td>
                    <td class="py-2">
                      {{product.totalGrossValue}}
                    </td>
                  </tr>
                </ng-container>

                <tr style="background-color: #507ee1"><th colspan="2">Documents</th><th>Total Net</th><th>Total Vat</th><th>Total Gross</th></tr>
                <tr class="has-text-left">
                  <td class="py-2" colspan="2">
                    {{supplier.numberOfDocuments}}
                  </td>
                  <td class="py-2">
                    {{supplier.totalNetValue}}
                  </td>
                  <td class="py-2">
                    {{supplier.totalVatValue}}
                  </td>
                  <td class="py-2">
                    {{supplier.totalGrossValue}}
                  </td>
                </tr>

              </ng-container>
              <br />
              </tbody>
            </ng-container>
          </table>
        </div>

<!--        <pre>{{fetched.msv.data | json}}</pre>-->

        <div *ngIf="this.fetched.msv.data.length == 0" class="has-text-centered">
          NOT FOUND ANY ITEMS
        </div>

      </div>
    </div>
  </section>
</div>
